MDBoxLayout:
    id: root_container
    orientation: 'vertical'

    MDScreenManager:
        id: main_screen_manager

        MDScreen:
            id: current_screen
            name: 'Current'
            md_bg_color: app.theme_cls.backgroundColor
            
            MDBoxLayout:
                id: current_screen_layout
                orientation: 'vertical'

                MDTopAppBar:
                    id: current_screen_title_bar
                    type: 'small'
                    
                    MDTopAppBarTitle:
                        id: current_screen_title
                        text: "Current"

                    MDTopAppBarTrailingButtonContainer:

                        MDActionTopAppBarButton:
                            id: current_screen_add_task_button
                            icon: "plus"
                            on_press: app.add_to_active_screen("Current")

                MDScrollView:
                    id: current_screen_scroll_view

                    MDBoxLayout:
                        id: current_screen_container
                        orientation: 'vertical'
                        size_hint_y: None
                        height: self.minimum_height
                        spacing: dp(5)
                        padding: dp(18), dp(5)

        MDScreen:
            id: repeat_screen
            name: 'Repeat'
            md_bg_color: app.theme_cls.backgroundColor
        
            MDBoxLayout:
                id: repeat_screen_layout
                orientation: 'vertical'

                MDTopAppBar:
                    id: repeat_screen_title_bar
                    type: 'small'
                    
                    MDTopAppBarTitle:
                        id: repeat_screen_title
                        text: "Repeat"

                    MDTopAppBarTrailingButtonContainer:

                        MDActionTopAppBarButton:
                            id: repeat_screen_add_task_button
                            icon: "plus"
                            on_press: app.add_to_active_screen("Repeat")

                MDScrollView:
                    id: repeat_screen_scroll_view

                    MDBoxLayout:
                        id: repeat_screen_container
                        orientation: 'vertical'
                        size_hint_y: None
                        height: self.minimum_height
                        spacing: dp(5)
                        padding: dp(18), dp(5)

        MDScreen:
            id: list_screen
            name: "List"
            md_bg_color: app.theme_cls.backgroundColor
                        
            MDBoxLayout:
                id: list_screen_layout
                orientation: 'vertical'

                MDTopAppBar:
                    id: list_screen_title_bar
                    type: 'small'
                    
                    MDTopAppBarTitle:
                        id: list_screen_title
                        text: "List"

                    MDTopAppBarTrailingButtonContainer:

                        MDActionTopAppBarButton:
                            id: list_screen_add_item_button
                            icon: "plus"
                            on_press: app.add_to_active_screen("List")

                MDScrollView:
                    id: list_screen_scroll_view

                    MDBoxLayout:
                        id: list_screen_container
                        orientation: 'vertical'
                        size_hint_y: None
                        height: self.minimum_height
                        spacing: dp(5)
                        padding: dp(18), dp(5)

        MDScreen:
            id: stats_screen
            name: 'Stats'
            md_bg_color: app.theme_cls.backgroundColor
            
            MDBoxLayout:
                id: stats_screen_layout
                orientation: 'vertical'

                MDTopAppBar:
                    id: title_bar
                    type: 'small'
                    
                    MDTopAppBarTitle:
                        id: title
                        text: "Stats"

                    MDTopAppBarTrailingButtonContainer:

                        MDActionTopAppBarButton:
                            icon: "plus"
                            on_press: app.cycle_color_schemes()

                MDBoxLayout:
                    id: stats_screen_container
                    orientation: 'vertical'
                    padding: dp(43), dp(25), dp(33), dp(43)
                    spacing: dp(20)

                    canvas.before:
                        Color:
                            rgba: app.theme_cls.secondaryContainerColor
                        RoundedRectangle:
                            pos: self.x + dp(18), self.y + dp(18)
                            size: self.width - dp(36), self.height - dp(18)
                            radius: (dp(15), dp(15))
                        
                    MDBoxLayout:
                        id: progress_bar_container
                        orientation: 'vertical'
                        size_hint_y: None
                        height: self.minimum_height
                        padding: dp(0), dp(0), dp(10), dp(0)
                        spacing: dp(10)

                        MDLabel:
                            text: "Progress"
                            halign: "center"
                            font_style: "Title"
                            role: "large"
                            size_hint_y: None
                            height: dp(36)
        
                        ProgressBarWidget:
                            id: progress_bar
                            size_hint_y: None
                            height: dp(10)

                            canvas.before:
                                Color:
                                    rgba: app.theme_cls.onSurfaceColor
                                RoundedRectangle:
                                    size: self.size
                                    pos: self.pos
                                    radius: [dp(5),dp(5),dp(5),dp(5)]
                                Color:
                                    rgba: app.theme_cls.secondaryContainerColor
                                RoundedRectangle:
                                    size: progress_bar.width - dp(4), progress_bar.height - dp(4)
                                    pos: progress_bar.x + dp(2), progress_bar.y + dp(2)
                                    radius: [dp(3),dp(3),dp(3),dp(3)]

                        MDBoxLayout:
                            id: progress_level_container
                            orientation: 'horizontal'
                            size_hint_y: None
                            height: dp(24)
                            padding: dp(10), dp(0)
                    
                            MDLabel:
                                id: start_level
                                halign: "left"
                                size_hint_x: None
                                width: dp(40)

                            MDLabel:
                                id: xp_to_next_level
                                halign: "center"
                                font_style: "Title"
                                role: "small"
                            
                            MDLabel:
                                id: next_level
                                halign: "right"
                                size_hint_x: None
                                width: dp(40)

                    MDBoxLayout:
                        orientation: 'vertical'
                        spacing: dp(5)
                        
                        MDLabel:
                            id: completed_tasks_label
                            text: "Completed Tasks"
                            halign: "center"
                            size_hint_y: None
                            height: dp(24)

                        MDBoxLayout:
                            padding: dp(10), dp(10), dp(0), dp(10)

                            canvas.before:
                                Color:
                                    rgba: app.theme_cls.backgroundColor
                                RoundedRectangle:
                                    pos: self.x, self.y
                                    size: self.width - dp(10), self.height
                                    radius: (dp(10), dp(10))

                            MDScrollView:
                                id: completed_tasks_scroll_view

                                MDBoxLayout:
                                    id: completed_tasks_layout
                                    orientation: 'vertical'
                                    size_hint_y: None
                                    height: self.minimum_height
                                    padding: dp(0), dp(0), dp(20), dp(0)

                    MDBoxLayout:
                        orientation: 'vertical'
                        spacing: dp(5)

                        MDLabel:
                            id: purchased_items_label
                            text: "Purchased Items"
                            halign: "center"
                            size_hint_y: None
                            height: dp(24)

                        MDBoxLayout:
                            padding: dp(10), dp(10), dp(0), dp(10)

                            canvas.before:
                                Color:
                                    rgba: app.theme_cls.backgroundColor
                                RoundedRectangle:
                                    pos: self.x, self.y
                                    size: self.width - dp(10), self.height
                                    radius: (dp(10), dp(10))

                            MDScrollView:
                                id: purchased_items_scroll_view

                                MDBoxLayout:
                                    id: purchased_items_layout
                                    orientation: 'vertical'
                                    size_hint_y: None
                                    height: self.minimum_height
                                    padding: dp(0), dp(0), dp(20), dp(0)
                    

    MDNavigationBar:
        id: nav_bar_container
        on_switch_tabs: app.on_switch_tabs(*args)
        
        MDNavigationItem:
            id: current_navigation_container
            active: True

            MDNavigationItemIcon:
                icon: "calendar"

            MDNavigationItemLabel:
                text: "Current"

        MDNavigationItem:
            id: repeat_navigation_container

            MDNavigationItemIcon:
                icon: "calendar-clock"

            MDNavigationItemLabel:
                text: "Repeat"        

        MDNavigationItem:
            id: list_navigation_container

            MDNavigationItemIcon:
                icon: "format-list-bulleted-square"

            MDNavigationItemLabel:
                text: "List"

        MDNavigationItem:
            id: stats_navigation_container

            MDNavigationItemIcon:
                icon: "format-list-numbered"

            MDNavigationItemLabel:
                text: "Stats"
    

<TaskButton>:
    style: "tonal"
    theme_width: "Custom"
    size_hint_x: 1
    height: dp(56)
    radius: dp(15)
    on_press: app.display_task_details(self)

    MDButtonText:
        id: task_button_text
        font_style: "Title"
        role: "medium"
        

<ItemButton>:
    style: "tonal"
    theme_width: "Custom"
    size_hint_x: 1
    height: dp(56)
    radius: dp(15)
    on_press: app.display_item_details(self)

    MDButtonText:
        id: item_button_text
        font_style: "Title"
        role: "medium"


<TaskDialog>:
    id: task_dialog_root
    size_hint: None, None
    height: self.minimum_height
    width: self.minimum_width
    radius: dp(15)

    MDFloatLayout:
        id: task_dialog_layout
        size_hint: None, None
        size: dp(324), dp(500)

        MDLabel:
            text: "Task Details"
            text_size: dp(274), dp(24)
            halign: "center"
            valign: "middle"
            font_style: "Title"
            role: "large"
            size_hint: None, None
            size: dp(274), dp(24)
            pos: self.parent.x + dp(25), self.parent.y + dp(446)

        DialogTextFieldAutocomplete:
            id: task_dialog_title
            required: True
            size_hint_x: None
            width: dp(274)
            pos: self.parent.x + dp(25), self.parent.y + dp(368)

            MDTextFieldHintText:
                text: "name"

        DialogButtonSmall:
            id: task_dialog_repeat_button
            style: "outlined"
            radius: dp(7)
            size_hint_x: None
            width: dp(95)
            pos: self.parent.x + dp(37), self.parent.y + dp(313)
            on_press: task_dialog_root.repeat_button_toggle(self)

            MDButtonText:
                id: task_dialog_repeat_button_text
                text: "Repeat"

        MDDivider:
            id: steps_divider_top
            size_hint_x: None
            width: dp(274)
            pos: self.parent.x + dp(25), self.parent.y + dp(298)

        MDBoxLayout:
            id: steps_container
            orientation: 'vertical'
            size_hint: None, None
            size: dp(274), self.minimum_height
            pos: self.parent.x + dp(25), self.parent.y + dp(95)
            spacing: dp(10)

            DialogTextField:
                id: first_step
                
                MDTextFieldHintText:
                    text: "first step"

            DialogTextField:
                id: second_step

                MDTextFieldHintText:
                    text: "second step"

            DialogTextField:
                id: third_step

                MDTextFieldHintText:
                    text: "third step"
                
        MDDivider:
            id: steps_divider_top
            size_hint_x: None
            width: dp(274)
            pos: self.parent.x + dp(25), self.parent.y + dp(80)

        MDScreenManager:
            id: task_dialog_screen_manager
            pos: self.parent.x, self.parent.y
            
            MDScreen:
                name: 'Current'

                MDFloatLayout:

                    MDBoxLayout:
                        id: current_screen_repeat_toggle_container
                        orientation: 'horizontal'
                        size_hint: None, None
                        size: dp(155), self.minimum_height
                        pos: self.parent.x + dp(132), self.parent.y + dp(313)

                        MDLabel:
                            id: current_screen_repeat_toggle_spacer
                            text: 'in'
                            halign: "center"

                        DialogButtonSmall:
                            id: current_screen_repeat_interval
                            style: "filled"
                            radius: dp(7)
                            size_hint_x: None
                            width: dp(95)
                            on_press: task_dialog_root.cycle_interval(current_screen_repeat_interval_text)

                            MDButtonText:
                                id: current_screen_repeat_interval_text

                    MDBoxLayout:
                        id: current_screen_task_buttons_container
                        orientation: 'horizontal'
                        size_hint_x: None
                        width: dp(274)
                        pos: self.parent.x + dp(25), self.parent.y + dp(25)

                        MDButton:
                            id: current_screen_task_complete_button
                            radius: dp(7)
                            on_press: task_dialog_root.complete_task()

                            MDButtonIcon:
                                id: current_screen_task_complete_button_icon
                                icon: "plus"

                            MDButtonText:
                                id: current_screen_task_complete_button_text
                                text: "Complete"
                        Widget:
                            id: current_screen_spacer

                        MDButton:
                            id: current_screen_task_delete_button
                            radius: dp(7)
                            on_press: task_dialog_root.delete_task(app.root.ids.main_screen_manager.current)

                            MDButtonIcon:
                                id: current_screen_task_delete_button_icon
                                icon: "trash-can-outline"

                            MDButtonText:
                                id: current_screen_task_delete_button_text
                                text: "Delete"

            MDScreen:
                name: 'Repeat'

                MDFloatLayout:

                    MDBoxLayout:
                        id: repeat_screen_repeat_toggle_container
                        orientation: 'horizontal'
                        size_hint: None, None
                        size: dp(155), self.minimum_height
                        pos: self.parent.x + dp(132), self.parent.y + dp(313)

                        MDLabel:
                            id: repeat_screen_repeat_toggle_spacer
                            text: 'on'
                            halign: "center"

                        DialogButtonSmall:
                            id: repeat_screen_repeat_interval
                            style: "filled"
                            radius: dp(7)
                            size_hint_x: None
                            width: dp(95)
                            on_press: task_dialog_root.open_date_picker()

                            MDButtonText:
                                id: repeat_screen_repeat_interval_text

                    MDBoxLayout:
                        id: repeat_screen_task_buttons_container
                        orientation: 'horizontal'
                        size_hint_x: None
                        width: dp(274)
                        pos: self.parent.x + dp(25), self.parent.y + dp(25)

                        DialogButtonLarge:
                            id: repeat_screen_task_delete_button
                            radius: dp(7)
                            on_press: task_dialog_root.delete_task(app.root.ids.main_screen_manager.current)

                            MDButtonIcon:
                                id: repeat_screen_task_delete_button_icon
                                icon: "trash-can-outline"

                            MDButtonText:
                                id: repeat_screen_task_delete_button_text
                                text: "Delete"

<DialogTextField>:
    mode: "outlined"
    theme_line_color: "Custom"
    radius: dp(7)


<DeleteRepeatTaskDialog>:
    id: delete_repeat_task_dialog_root
    radius: dp(15)
    size_hint: None, None
    height: self.minimum_height
    width: self.minimum_width

    MDFloatLayout:
        id: delete_repeat_task_dialog_layout
        size_hint: None, None
        size: dp(300), dp(200)

        MDLabel:
            id: delete_repeat_task_dialog_title
            text: "Repeat task?"
            halign: "center"
            font_style: "Headline"
            role: "small"
            size_hint: None, None
            size: dp(260), dp(26)
            pos: self.parent.x + dp(20), self.parent.y + dp(180) - self.height

        MDLabel:
            id: delete_repeat_task_dialog_description
            text: "Currently this task is set to repeat. Would you like to keep or delete future instances of this task?"
            halign: "center"
            font_style: "Title"
            role: "small"
            size_hint: None, None
            size: dp(260), dp(40)
            pos: self.parent.x + dp(20), self.parent.y + dp(130) - self.height

        MDBoxLayout:
            id: delete_repeat_task_dialog_button_container
            orientation: 'horizontal'
            size_hint: None, None
            size: dp(260), self.minimum_height
            pos: self.parent.x + dp(20), self.parent.y + dp(20)

            MDButton:
                id: delete_future_task_dialog_accept
                on_press: delete_repeat_task_dialog_root.schedule_repeat_task()

                MDButtonText:
                    text: "Keep"

            Widget:
                id: spacer

            MDButton:
                id: delete_future_task_dialog_decline
                on_press: delete_repeat_task_dialog_root.delete_selected_task()

                MDButtonText:
                    text: "Delete"


<ItemDialog>:
    id: item_dialog_root
    radius: dp(15)
    size_hint: None, None
    height: self.minimum_height
    width: self.minimum_width

    MDFloatLayout:
        id: item_dialog_layout
        size_hint: None, None
        size: dp(324), dp(379)

        MDLabel:
            text: "Item Details"
            text_size: dp(274), dp(24)
            halign: "center"
            valign: "middle"
            font_style: "Title"
            role: "large"
            size_hint: None, None
            size: dp(274), dp(24)
            pos: self.parent.x + dp(25), self.parent.y + dp(325)

        DialogTextFieldAutocomplete:
            id: item_dialog_title
            required: True
            size_hint_x: None
            width: dp(274)
            pos: self.parent.x + dp(25), self.parent.y + dp(247)

            MDTextFieldHintText:
                text: "name"

        MDDivider:
            id: item_dialog_divider_top
            size_hint_x: None
            width: dp(274)
            pos: self.parent.x + dp(25), self.parent.y + dp(232)

        MDBoxLayout:
            id: item_dialog_container
            orientation: 'vertical'
            size_hint: None, None
            size: dp(274), self.minimum_height
            pos: self.parent.x + dp(25), self.parent.y + dp(95)
            spacing: dp(10)

            DialogTextFieldAutocomplete:
                id: item_dialog_location

                MDTextFieldHintText:
                    text: "location"

            MDBoxLayout:
                id: item_dialog_quantity_container
                orientation: 'horizontal'
                size_hint: None, None
                size: dp(274), self.minimum_height
                spacing: dp(25)

                DialogNumberField:
                    id: item_dialog_quantity

                    MDTextFieldHintText:
                        text: "quantity"

                DialogButtonSmall:
                    id: item_dialog_units_button
                    radius: dp(7)
                    size_hint_x: None
                    width: dp(95)
                    on_press: item_dialog_root.cycle_unit(item_dialog_units_text)

                    MDButtonText:
                        id: item_dialog_units_text

        MDDivider:
            id: item_dialog_divider_bottom
            size_hint_x: None
            width: dp(274)
            pos: self.parent.x + dp(25), self.parent.y + dp(80)

        MDBoxLayout:
            id: item_dialog_buttons_container
            orientation: 'horizontal'
            size_hint_x: None
            width: dp(274)
            pos: self.parent.x + dp(25), self.parent.y + dp(25)

            MDButton:
                id: item_dialog_complete_button
                radius: dp(7)
                on_press: item_dialog_root.complete_task()

                MDButtonIcon:
                    id: item_dialog_complete_button_icon
                    icon: "plus"

                MDButtonText:
                    id: item_dialog_complete_button_text
                    text: "Complete"
            Widget:
                id: current_screen_spacer

            MDButton:
                id: item_dialog_delete_button
                radius: dp(7)
                on_press: item_dialog_root.delete_task()

                MDButtonIcon:
                    id: item_dialog_delete_button_icon
                    icon: "trash-can-outline"

                MDButtonText:
                    id: item_dialog_delete_button_text
                    text: "Delete"

<CompletedWidget>:
    id: completed_task_widget
    orientation: 'horizontal'
    size_hint_y: None
    height: dp(24)

    MDLabel:
        id: completed_task_name

    MDLabel:
        id: completed_task_count
        halign: "right"
